id: dashboard
type: PageHeaderMenu
properties:
  title: Dashboard

requests:
  - id: get_tasks
    type: MongoDBFind
    connectionId: record_task
    properties:
      query: {}
      projection:
        _id: 0
        task: 1
        desc: 1
        priority: 1
  - id: get_BT_entries
    type: MongoDBFind
    connectionId: testBT_test1
    properties:
      query: {}
      projection:
        _id: 0

events:
  onMount:
    - id: get_tasks
      type: Request
      params: get_tasks
    - id: get_BT_entries
      type: Request
      params: get_BT_entries

blocks:
  - id: default
    type: Breadcrumb
    properties:
      separator: '>'
      list:
        - label: Home
          pageId: home
        - label: Dashboard
          pageId: dashboard
  - id: tabs
    type: Tabs
    properties:
      defaultActiveKey: score_tab
      size: small
      tabPosition: left
      tabs:
        - key: score_tab
          title: Scores
          icon: AiOutlineExclamation
        - key: chart_tab
          title: Charts
          icon: AiFillCamera
        - key: task_tab
          title: Tasks
          icon: AiFillBell
        - key: memo_tab
          title: Memos
          icon: AiFillBell
        - key: record_tab
          title: Records
          icon: AiFillBell
    areas:
      score_tab:
        blocks:
          - id: score_wrapper
            type: Card
            properties:
              title: Scores
            layout:
              span: 6
              contentJustify: center
            blocks:
              - _ref:
                  path: date_selector.yaml
                  vars:
                    id: score_date

      chart_tab:
        blocks:
          - id: row1
            type: Box
            layout:
              contentGutter: 24
            blocks:
              - _ref: charts/line_chart1.yaml
              - _ref: charts/pie_chart1.yaml

          - id: divider1
            type: Divider

          - id: row2
            type: Box
            blocks:
              - _ref: charts/tree_chart1.yaml

          - id: row3
            type: Box
            blocks:
              - _ref: charts/tree_chart2.yaml

      task_tab:
        blocks:
          - id: task_wrapper
            type: Box
            layout:
              contentGutter: 20
            blocks:
              - id: task_card1
                type: Card
                properties:
                  hoverable: true
                  title: View Tasks
                blocks:
                  - id: task_table1
                    type: AgGridBalham
                    properties:
                      enableCellTextSelection: true
                      pagination: true
                      rowData:
                        _request: get_tasks
                      defaultColDef:
                        sortable: true
                        resizable: true
                        filter: true
                      columnDefs:
                        - headerName: Task
                          field: task
                          flex: 1
                          filter: false
                        - headerName: Description
                          field: desc
                          flex: 2
                          filter: false
                        - headerName: Priority
                          field: priority
                          flex: 1
                          filter: false

      memo_tab:
        blocks:
          - id: memo_wrapper
            type: Box
            layout:
              contentGutter: 20
            blocks:
              - id: memo_card1
                type: Card
                properties:
                  hoverable: true
                  title: Memo 1
                style:
                  maxWidth: 300
                blocks:
                  - id: memo_content1
                    type: Markdown
                    properties:
                      content: "**This is a markdown text.**"
              - id: memo_card2
                type: Card
                properties:
                  hoverable: true
                  title: Memo 2
                style:
                  maxWidth: 300
                blocks:
                  - id: memo_content2
                    type: Markdown
                    properties:
                      content: "**This is another markdown text.**"
      record_tab:
        blocks:
          - id: block_id
            type: Collapse
            properties:
              accordion: true
              bordered: false
              defaultActiveKey: panel1
              panels:
                - key: panel1
                  extraKey: panel1Extra
                  title: Info Sources
                  disabled: false
                - key: panel2
                  title: BT Entries
                  disabled: false
                  extraKey: panel2Extra
            areas:
              panel1:
                blocks:
                  - id: source_record_wrapper
                    type: Box
                    layout:
                      contentGutter: 20
                    blocks:
                      - id: source_selector
                        type: Selector
                        layout:
                          span: 4
                        properties:
                          label:
                            disabled: true
                          options:
                            - label: Textbook
                              value: Textbook
                            - label: Wikipage
                              value: Wikipage
                          placeholder: Select a source to view
                        events:
                          onChange:
                            - id: set_source
                              type: SetState
                              params:
                                source:
                                  _state: source_selector

                      - id: query_button
                        type: Button
                        layout:
                          span: 3
                        properties:
                          color: "#ca7af0"
                          shape: round
                          title:
                            _string.concat:
                              - "Query: "
                              - _state: source



                      - id: souce_table
                        type: AgGridBalham
                        properties:
                          enableCellTextSelection: true
                          pagination: true
                          rowData:
                            _request: get_books
                          defaultColDef:
                            sortable: true
                            resizable: true
                            filter: true
                          columnDefs:
                            - headerName: ID
                              field: _id._oid
                              flex: 3
                              filter: false
                            - headerName: Book Name
                              field: book
                              flex: 2
                              filter: false
                            - headerName: Description
                              field: desc
                              flex: 8
                              filter: false
                            - headerName: Field
                              field: field
                              flex: 2.5
                              filter: false
                            - headerName: Status
                              field: status
                              flex: 2
                              filter: false
                            - headerName: Priority
                              field: priority
                              flex: 2
                              filter: false
              panel2:
                blocks:
                  - id: source_record_wrapper
                    type: Box
                    layout:
                      contentGutter: 20
                    blocks:
                      - id: BT_level_selector
                        type: Selector
                        layout:
                          span: 4
                        properties:
                          label:
                            disabled: true
                          options:
                            - label: lv1
                              value: 1
                            - label: lv2
                              value: 2
                            - label: lv3
                              value: 3
                            - label: lv4
                              value: 4
                            - label: lv5
                              value: 5
                            - label: lv6
                              value: 6
                          placeholder: Select a BT level
                      - id: BT_table
                        type: AgGridBalham
                        layout:
                          span: 6
                        properties:
                          enableCellTextSelection: true
                          pagination: true
                          rowData:
                            _request: get_BT_entries
                          defaultColDef:
                            sortable: true
                            resizable: true
                            filter: true
                          columnDefs:
                            - headerName: Date
                              field: date
                              flex: 2
                              filter: false
                            - headerName: BT Score
                              field: bt_score
                              flex: 1


